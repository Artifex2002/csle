syntax = "proto3";

// Interface exported by the server
service ClusterManager {
  rpc getNodeStatus(GetNodeStatusMsg) returns (NodeStatusDTO) {}
  rpc startPostgreSQL(StartPostgreSQLMsg) returns (ServiceStatusDTO) {}
  rpc startCAdvisor(StartCAdvisorMsg) returns (ServiceStatusDTO) {}
  rpc startNodeExporter(StartNodeExporterMsg) returns (ServiceStatusDTO) {}
  rpc startGrafana(StartGrafanaMsg) returns (ServiceStatusDTO) {}
  rpc startPrometheus(StartPrometheusMsg) returns (ServiceStatusDTO) {}
  rpc startPgAdmin(StartPgAdminMsg) returns (ServiceStatusDTO) {}
  rpc startNginx(StartNginxMsg) returns (ServiceStatusDTO) {}
  rpc startFlask(StartFlaskMsg) returns (ServiceStatusDTO) {}
  rpc startDockerStatsManager(StartDockerStatsManagerMsg) returns (ServiceStatusDTO) {}
  rpc startDockerStatsManagerThread(StartDockerStatsManagerThreadMsg) returns (ServiceStatusDTO) {}
  rpc startDockerEngine(StartDockerEngineMsg) returns (ServiceStatusDTO) {}
  rpc stopPostgreSQL(StopPostgreSQLMsg) returns (ServiceStatusDTO) {}
  rpc stopCAdvisor(StopCAdvisorMsg) returns (ServiceStatusDTO) {}
  rpc stopNodeExporter(StopNodeExporterMsg) returns (ServiceStatusDTO) {}
  rpc stopGrafana(StopGrafanaMsg) returns (ServiceStatusDTO) {}
  rpc stopPrometheus(StopPrometheusMsg) returns (ServiceStatusDTO) {}
  rpc stopPgAdmin(StopPgAdminMsg) returns (ServiceStatusDTO) {}
  rpc stopNginx(StopNginxMsg) returns (ServiceStatusDTO) {}
  rpc stopFlask(StopFlaskMsg) returns (ServiceStatusDTO) {}
  rpc stopDockerStatsManager(StopDockerStatsManagerMsg) returns (ServiceStatusDTO) {}
  rpc stopDockerEngine(StopDockerEngineMsg) returns (ServiceStatusDTO) {}
  rpc getCsleLogFiles(GetCsleLogFilesMsg) returns (LogsDTO) {}
  rpc getDockerStatsManagerLogs(GetDockerStatsManagerLogsMsg) returns (LogsDTO) {}
  rpc getPrometheusLogs(GetPrometheusLogsMsg) returns (LogsDTO) {}
  rpc getNodeExporterLogs(GetNodeExporterLogsMsg) returns (LogsDTO) {}
  rpc getCadvisorLogs(GetCAdvisorLogsMsg) returns (LogsDTO) {}
  rpc getPgAdminLogs(GetPgAdminLogsMsg) returns (LogsDTO) {}
  rpc getGrafanaLogs(GetGrafanaLogsMsg) returns (LogsDTO) {}
  rpc getNginxLogs(GetNginxLogsMsg) returns (LogsDTO) {}
  rpc getDockerLogs(GetDockerLogsMsg) returns (LogsDTO) {}
  rpc getPostrgreSQLLogs(GetPostgreSQLLogsMsg) returns (LogsDTO) {}
  rpc getFlaskLogs(GetFlaskLogsMsg) returns (LogsDTO) {}
  rpc getLogFile(GetLogFileMsg) returns (LogsDTO) {}
  rpc startContainersInExecution(StartContainersInExecutionMsg) returns (OperationOutcomeDTO) {}
  rpc attachContainersInExecutionToNetworks(AttachContainersToNetworksInExecutionMsg) returns (OperationOutcomeDTO) {}
  rpc installLibraries(InstallLibrariesMsg) returns (OperationOutcomeDTO) {}
  rpc applyKafkaConfig(ApplyKafkaConfigMsg) returns (OperationOutcomeDTO) {}
  rpc startSdnController(StartSdnControllerMsg) returns (OperationOutcomeDTO) {}
  rpc applyResourceConstraints(ApplyResouceConstraintsMsg) returns (OperationOutcomeDTO) {}
  rpc createOvsSwitches(CreateOvsSwitchesMsg) returns (OperationOutcomeDTO) {}
  rpc pingExecution(PingExecutionMsg) returns (OperationOutcomeDTO) {}
  rpc configureOvs(ConfigureOvsMsg) returns (OperationOutcomeDTO) {}
  rpc startSdnControllerMonitor(StartSdnControllerMonitorMsg) returns (OperationOutcomeDTO) {}
  rpc createUsers(CreateUsersMsg) returns (OperationOutcomeDTO) {}
  rpc createVulnerabilities(CreateVulnsMsg) returns (OperationOutcomeDTO) {}
  rpc createFlags(CreateFlagsMsg) returns (OperationOutcomeDTO) {}
  rpc createTopology(CreateTopologyMsg) returns (OperationOutcomeDTO) {}
  rpc startTrafficManagers(StartTrafficManagersMsg) returns (OperationOutcomeDTO) {}
  rpc startTrafficGenerators(StartTrafficGeneratorsMsg) returns (OperationOutcomeDTO) {}
  rpc startClientPopulation(StartClientPopulationMsg) returns (OperationOutcomeDTO) {}
  rpc startKafkaClientProducer(StartKafkaClientProducerMsg) returns (OperationOutcomeDTO) {}
  rpc stopKafkaClientProducer(StopKafkaClientProducerMsg) returns (OperationOutcomeDTO) {}
  rpc startSnortIdses(StartSnortIdsesMsg) returns (OperationOutcomeDTO) {}
  rpc startSnortIdsesMonitorThreads(StartSnortIdsesMonitorThreadsMsg) returns (OperationOutcomeDTO) {}
  rpc startOssecIdses(StartOSSECIdsesMsg) returns (OperationOutcomeDTO) {}
  rpc startOssecIdsesMonitorThreads(StartOSSECIdsesMonitorThreadsMsg) returns (OperationOutcomeDTO) {}
  rpc startElkStack(StartElkStackMsg) returns (OperationOutcomeDTO) {}
  rpc startHostManagers(StartHostManagersMsg) returns (OperationOutcomeDTO) {}
  rpc applyFileBeatsConfig(ApplyFileBeatConfigsMsg) returns (OperationOutcomeDTO) {}
  rpc applyPacketBeatsConfig(ApplyPacketBeatConfigsMsg) returns (OperationOutcomeDTO) {}
  rpc applyMetricBeatsConfig(ApplyMetricBeatConfigsMsg) returns (OperationOutcomeDTO) {}
  rpc applyHeartBeatsConfig(ApplyHeartBeatConfigsMsg) returns (OperationOutcomeDTO) {}
  rpc startFilebeats(StartFileBeatsMsg) returns (OperationOutcomeDTO) {}
  rpc startPacketbeats(StartPacketBeatsMsg) returns (OperationOutcomeDTO) {}
  rpc startMetricbeats(StartMetricBeatsMsg) returns (OperationOutcomeDTO) {}
  rpc startHeartbeats(StartHeartBeatsMsg) returns (OperationOutcomeDTO) {}
  rpc stopAllExecutionsOfEmulation(StopAllExecutionsOfEmulationMsg) returns (OperationOutcomeDTO) {}
  rpc stopExecution(StopExecutionMsg) returns (OperationOutcomeDTO) {}
  rpc stopAllExecutions(StopAllExecutionsMsg) returns (OperationOutcomeDTO) {}
  rpc cleanAllExecutions(CleanAllExecutionsMsg) returns (OperationOutcomeDTO) {}
  rpc cleanAllExecutionsOfEmulation(CleanAllExecutionsOfEmulationMsg) returns (OperationOutcomeDTO) {}
  rpc cleanExecution(CleanExecutionMsg) returns (OperationOutcomeDTO) {}
  rpc startTrafficManager(StartTrafficManagerMsg) returns (OperationOutcomeDTO) {}
  rpc stopTrafficManager(StartTrafficManagerMsg) returns (OperationOutcomeDTO) {}
  rpc stopTrafficManagers(StartTrafficManagersMsg) returns (OperationOutcomeDTO) {}
  rpc startClientManager(StartClientManagerMsg) returns (OperationOutcomeDTO) {}
  rpc stopClientPopulation(StopClientPopulationMsg) returns (OperationOutcomeDTO) {}
  rpc stopClientManager(StopClientManagerMsg) returns (OperationOutcomeDTO) {}
  rpc getNumActiveClients(GetNumActiveClientsMsg) returns (GetNumClientsDTO) {}
  rpc startTrafficGenerator(StartTrafficGeneratorMsg) returns (OperationOutcomeDTO) {}
  rpc stopTrafficGenerators(StopTrafficGeneratorsMsg) returns (OperationOutcomeDTO) {}
  rpc stopTrafficGenerator(StopTrafficGeneratorMsg) returns (OperationOutcomeDTO) {}
  rpc getClientManagersInfo(GetClientManagersInfoMsg) returns (ClientManagersInfoDTO) {}
  rpc getTrafficManagersInfo(GetTrafficManagersInfoMsg) returns (TrafficManagerInfoDTO) {}
  rpc stopAllRunningContainers(StopAllRunningContainersMsg) returns (OperationOutcomeDTO) {}
  rpc stopContainer(StopContainerMsg) returns (OperationOutcomeDTO) {}
  rpc removeAllStoppedContainers(RemoveAllStoppedContainersMsg) returns (OperationOutcomeDTO) {}
  rpc removeContainer(RemoveContainerMsg) returns (OperationOutcomeDTO) {}
  rpc removeAllContainerImages(RemoveAllContainerImagesMsg) returns (OperationOutcomeDTO) {}
  rpc removeContainerImage(RemoveContainerImageMsg) returns (OperationOutcomeDTO) {}
  rpc listAllContainerImages(ListAllContainerImagesMsg) returns (ContainerImagesDTO) {}
  rpc listAllDockerNetworks(ListAllDockerNetworksMsg) returns (DockerNetworksDTO) {}
  rpc startAllStoppedContainers(StartAllStoppedContainersMsg) returns (OperationOutcomeDTO) {}
  rpc startContainer(StartContainerMsg) returns (OperationOutcomeDTO) {}
  rpc listAllRunningContainers(ListAllRunningContainersMsg) returns (RunningContainersDTO) {}
  rpc listAllRunningEmulations(ListAllRunningEmulationsMsg) returns (RunningEmulationsDTO) {}
  rpc listAllStoppedContainers(ListAllStoppedContainersMsg) returns (StoppedContainersDTO) {}
  rpc createEmulationNetworks(CreateEmulationNetworksMsg) returns (OperationOutcomeDTO) {}
  rpc stopDockerStatsManagerThread(StopDockerStatsManagerThreadMsg) returns (OperationOutcomeDTO) {}
  rpc getDockerStatsManagerStatus(GetDockerStatsManagerStatusMsg) returns (DockerStatsMonitorStatusDTO) {}
  rpc removeDockerNetworks(RemoveDockerNetworksMsg) returns (OperationOutcomeDTO) {}
  rpc removeAllDockerNetworks(RemoveAllDockerNetworksMsg) returns (OperationOutcomeDTO) {}
  rpc getDockerStatsManagersInfo(GetDockerStatsManagersInfoMsg) returns (DockerStatsManagersInfoDTO) {}
  rpc startElkManager(StartElkManagerMsg) returns (OperationOutcomeDTO) {}
  rpc stopElkManager(StopElkManagerMsg) returns (OperationOutcomeDTO) {}
  rpc getElkStatus(GetElkStatusMsg) returns (ElkStatusDTO) {}
  rpc stopElkStack(StopElkStackMsg) returns (OperationOutcomeDTO) {}
  rpc startElastic(StartElasticMsg) returns (OperationOutcomeDTO) {}
  rpc stopElastic(StopElasticMsg) returns (OperationOutcomeDTO) {}
  rpc startKibana(StartKibanaMsg) returns (OperationOutcomeDTO) {}
  rpc stopKibana(StopKibanaMsg) returns (OperationOutcomeDTO) {}
  rpc startLogstash(StartLogstashMsg) returns (OperationOutcomeDTO) {}
  rpc stopLogstash(StopLogstashMsg) returns (OperationOutcomeDTO) {}
  rpc getElkManagersInfo(GetElkManagersInfoMsg) returns (ElkManagersInfoDTO) {}
}

// Message that the client sends when requesting to get the elk managers info
message GetElkManagersInfoMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the server returns when requested for the elk managers info
message ElkManagersInfoDTO {
  repeated string ips = 1;
  repeated int32 ports = 2;
  string emulationName = 3;
  int32 executionId = 4;
  repeated bool elkManagersRunning = 5;
  repeated ElkStatusDTO elkManagersStatuses = 6;
  int32 localKibanaPort = 7;
}

// Message that the client sends when requesting to stop logstash for a specific execution
message StopLogstashMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start logstash for a specific execution
message StartLogstashMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to stop Kibana for a specific execution
message StopKibanaMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start Kibana for a specific execution
message StartKibanaMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to stop Elastic for a specific execution
message StopElasticMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start Elastic for a specific execution
message StartElasticMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to stop the ELK stack of a specific execution
message StopElkStackMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the server returns when requested about status of the ELk stack
message ElkStatusDTO {
  bool elasticRunning = 1;
  bool kibanaRunning = 2;
  bool logstashRunning = 3;
}

// Message that the client sends when requesting to get the status of the ELK stack and the manager
message GetElkStatusMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to stop the elk manager
message StopElkManagerMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start the elk manager
message StartElkManagerMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to get the traffic managers info
message GetDockerStatsManagersInfoMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the server returns when requested for the docker stats managers info
message DockerStatsManagersInfoDTO {
  repeated string ips = 1;
  repeated int32 ports = 2;
  string emulationName = 3;
  int32 executionId = 4;
  repeated bool dockerStatsManagersRunning = 5;
  repeated DockerStatsMonitorStatusDTO dockerStatsManagersStatuses = 6;
}

// Message that the client sends to remove all CSLE docker networks
message RemoveAllDockerNetworksMsg {}

// Message that the client sends to remove a list of docker network
message RemoveDockerNetworksMsg {
  repeated string networks = 1;
}

// Message that the server returns when requested by the client, contains info about the docker stats monitor
message DockerStatsMonitorStatusDTO {
  int32 num_monitors = 1;
  repeated string emulations = 2;
  repeated int32 emulation_executions = 3;
}

// Message that the client sends to get the status of the docker stats manager of a specific execution
message GetDockerStatsManagerStatusMsg {
  int32 port = 1;
}

// Message that the client sends to stop a dockerStatsManager thread for an execution
message StopDockerStatsManagerThreadMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to create emulation networks
message CreateEmulationNetworksMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to list all stopped containers
message ListAllStoppedContainersMsg {}

//DTO with data related to all stopped containers
message StoppedContainersDTO {
  repeated DockerContainerDTO stoppedContainers = 1;
}

// Message that the client sends when requesting to list all running emulations
message ListAllRunningEmulationsMsg {}

//DTO with data related to all running emulations
message RunningEmulationsDTO {
  repeated string runningEmulations = 1;
}

// Message that the client sends when requesting to list all running containers
message ListAllRunningContainersMsg {}

//DTO with data related to all running containers
message RunningContainersDTO {
  repeated DockerContainerDTO runningContainers = 1;
}

//DTO with data related to a running container
message DockerContainerDTO {
  string name = 1;
  string image = 2;
  string ip = 3;
}

// Message that the client sends when requesting to start a specific container
message StartContainerMsg {
  string name = 1;
}

// Message that the client sends when requesting to start all stopped containers
message StartAllStoppedContainersMsg {}

// Message that the client sends when requesting to list all Docker networks
message ListAllDockerNetworksMsg {}

// Message that the server returns when requested for the Docker networks
message DockerNetworksDTO {
  repeated string networks = 1;
  repeated int32 network_ids = 2;
}

// Message that the server returns when requested for the container images
message ContainerImagesDTO {
  repeated ContainerImageDTO images = 1;
}

// DTO for a specific container image
message ContainerImageDTO {
  string repoTags = 1;
  string created = 2;
  string os = 3;
  string architecture = 4;
  string size = 5;
}

// Message that the client sends when requesting to list all container images
message ListAllContainerImagesMsg {}

// Message that the client sends when requesting to remove a specific container image
message RemoveContainerImageMsg {
  string name = 1;
}

// Message that the client sends when requesting to remove all container images
message RemoveAllContainerImagesMsg {}

// Message that the client sends when requesting to remove all stopped containers
message RemoveAllStoppedContainersMsg {}

// Message that the client sends when requesting to remove a specific container
message RemoveContainerMsg {
  string name = 1;
}

// Message that the client sends when requesting to stop a specific container
message StopContainerMsg {
  string name = 1;
}

// Message that the client sends when requesting to stop all running CSLE containers
message StopAllRunningContainersMsg {}

// Message that the client sends when requesting to get the traffic managers info
message GetTrafficManagersInfoMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the server returns when requested for the traffic managers info
message TrafficManagersInfoDTO {
  repeated string ips = 1;
  repeated int32 ports = 2;
  string emulationName = 3;
  int32 executionId = 4;
  repeated bool trafficManagersRunning = 5;
  repeated TrafficManagerInfoDTO trafficManagersStatuses = 6;
}

// Message that the server returns when requested for the info of a specific traffic manager
message TrafficManagerInfoDTO {
  bool running = 1;
  string script = 2;
}

// Message that the server returns when requested for the client managers info
message ClientManagersInfoDTO {
  repeated string ips = 1;
  repeated int32 ports = 2;
  string emulationName = 3;
  int32 executionId = 4;
  repeated bool clientManagersRunning = 5;
  repeated GetNumClientsDTO clientManagersStatuses = 6;
}

// Message that the client sends when requesting to get the client managers info
message GetClientManagersInfoMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start a specific traffic generator
message StartTrafficGeneratorMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
  string containerIp = 3;
}

// Message that the client sends when requesting to stop a specific traffic generator
message StopTrafficGeneratorMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
  string containerIp = 3;
}

// Message that the client sends when requesting to stop all traffic generators of a given execution
message StopTrafficGeneratorsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the server returns when the client requested the number of clients of a given execution
message GetNumClientsDTO {
  int32 num_clients = 1;
  bool client_process_active = 2;
  bool producer_active = 3;
  int32 clients_time_step_len_seconds = 4;
  int32 producer_time_step_len_seconds = 5;
}

// Message that the client sends when requesting to get the number of active clients of an execution
message GetNumActiveClientsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to stop the client population of a specific execution
message StopClientPopulationMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to stop the client manager of a specific execution
message StopClientManagerMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start the client manager of a specific execution
message StartClientManagerMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to stop all traffic managers of a given execution
message StopTrafficManagersMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to stop a specific traffic manager
message StopTrafficManagerMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
  string containerIp = 3;
}

// Message that the client sends when requesting to start a specific traffic manager
message StartTrafficManagerMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
  string containerIp = 3;
}

// Message that the client sends to clean all executions
message CleanAllExecutionsMsg {}

// Message that the client sends to stop all executions
message StopAllExecutionsMsg {}

// Message that the client sends to stop a given execution
message StopExecutionMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends to clean a given execution
message CleanExecutionMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends to stop all executions of a given emulation
message StopAllExecutionsOfEmulationMsg {
  string emulation = 1;
}

// Message that the client sends to clean all executions of a given emulation
message CleanAllExecutionsOfEmulationMsg {
  string emulation = 1;
}

// Message that the client sends to get the log file names in the /var/log/csle directory
message GetCsleLogFilesMsg {}

// Message that the client sends to get a given log file
message GetLogFileMsg {
  string name = 1;
}

// Message that the client sends when requesting to start containers of a given emulation execution
message StartContainersInExecutionMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to attach containers of a given emulation execution to networks
message AttachContainersToNetworksInExecutionMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to install CSLE libraries on containers that are part of an execution
message InstallLibrariesMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to apply the kafka config to a given execution
message ApplyKafkaConfigMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to apply start the SDN controller of an execution
message StartSdnControllerMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to apply resource constraints to containers of an emulation
message ApplyResouceConstraintsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to create OvsSwitches
message CreateOvsSwitchesMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to test ping between containers in an execution
message PingExecutionMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to configure OVS on an execution
message ConfigureOvsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start the SDN controller monitor in an execution
message StartSdnControllerMonitorMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to create users of an execution
message CreateUsersMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to create vulnerabilities of an execution
message CreateVulnsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to create flags of an execution
message CreateFlagsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to create the topology of an execution
message CreateTopologyMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start traffic managers of a given execution
message StartTrafficManagersMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start traffic generators of a given execution
message StartTrafficGeneratorsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start the client population of a specific execution
message StartClientPopulationMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start the client Kafka producer of a specific execution
message StartKafkaClientProducerMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to stop the client Kafka producer of a specific execution
message StopKafkaClientProducerMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start the Snort IDSes of a specific execution
message StartSnortIdsesMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start the Snort IDSes Monitor threads of a specific execution
message StartSnortIdsesMonitorThreadsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start the OSSEC IDSes of a specific execution
message StartOSSECIdsesMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start the OSSEC IDSes monitor threads of a specific execution
message StartOSSECIdsesMonitorThreadsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start the ELK stack of a specific execution
message StartElkStackMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start the Host managers of a specific execution
message StartHostManagersMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to apply the filebeat configurations of a specific execution
message ApplyFileBeatConfigsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to apply the packetbeat configurations of a specific execution
message ApplyPacketBeatConfigsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to apply the metricbeat configurations of a specific execution
message ApplyMetricBeatConfigsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to apply the heartbeat configurations of a specific execution
message ApplyHeartBeatConfigsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends when requesting to start the filebeats of an execution of a specific execution
message StartFileBeatsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
  bool initialStart = 3;
}

// Message that the client sends when requesting to start the packetbeats of an execution
message StartPacketBeatsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
  bool initialStart = 3;
}

// Message that the client sends when requesting to start the metricbeats of an execution
message StartMetricBeatsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
  bool initialStart = 3;
}

// Message that the client sends when requesting to start the heartbeats of an execution
message StartHeartBeatsMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
  bool initialStart = 3;
}

// Message that the client sends to get the docker statsmanager logs
message GetDockerStatsManagerLogsMsg {}

// Message that the client sends to get the Prometheus logs
message GetPrometheusLogsMsg {}

// Message that the client sends to get the Node exporter logs
message GetNodeExporterLogsMsg {}

// Message that the client sends to get the cAdvisor logs
message GetCAdvisorLogsMsg {}

// Message that the client sends to get the pgAdming logs
message GetPgAdminLogsMsg {}

// Message that the client sends to get the grafana logs
message GetGrafanaLogsMsg {}

// Message that the client sends to get the nginx logs
message GetNginxLogsMsg {}

// Message that the client sends to get the docker logs
message GetDockerLogsMsg {}

// Message that the client sends to get the posgresql logs
message GetPostgreSQLLogsMsg {}

// Message that the client sends to get the flask logs
message GetFlaskLogsMsg {}

// Message that the server returns after a request for logs
message LogsDTO {
  repeated string logs = 1;
}

// Message that the server returns after executing an operation requested by a client
message OperationOutcomeDTO {
  bool outcome = 1;
}

// Message that the client sends to get the status of the node
message GetNodeStatusMsg {}

// Message that the server returns when requested by the client, contains info about node's status
message NodeStatusDTO {
  string ip = 1;
  bool leader = 2;
  bool cAdvisorRunning = 3;
  bool prometheusRunning = 4;
  bool grafanaRunning = 5;
  bool pgAdminRunning = 6;
  bool nginxRunning = 7;
  bool flaskRunning = 8;
  bool dockerStatsManagerRunning = 9;
  bool nodeExporterRunning = 10;
  bool postgreSQLRunning = 11;
  bool dockerEngineRunning = 12;
}

// Message that the server returns when changing the status of a service
message ServiceStatusDTO {
  bool running = 1;
}

// Message that the client sends to start PostgreSQL
message StartPostgreSQLMsg {}

// Message that the client sends to start cAdvisor
message StartCAdvisorMsg {}

// Message that the client sends to start node exporter
message StartNodeExporterMsg {}

// Message that the client sends to start grafana
message StartGrafanaMsg {}

// Message that the client sends to start Prometheus
message StartPrometheusMsg {}

// Message that the client sends to start pgAdmin
message StartPgAdminMsg {}

// Message that the client sends to start nginx
message StartNginxMsg {}

// Message that the client sends to start flask
message StartFlaskMsg {}

// Message that the client sends to start dockerStatsManager
message StartDockerStatsManagerMsg {}

// Message that the client sends to start a dockerStatsManager thread for an execution
message StartDockerStatsManagerThreadMsg {
  string emulation = 1;
  int32 ipFirstOctet = 2;
}

// Message that the client sends to start the docker engine
message StartDockerEngineMsg {}

// Message that the client sends to stop PostgreSQL
message StopPostgreSQLMsg {}

// Message that the client sends to stop cAdvisor
message StopCAdvisorMsg {}

// Message that the client sends to stop node exporter
message StopNodeExporterMsg {}

// Message that the client sends to stop grafana
message StopGrafanaMsg {}

// Message that the client sends to stop Prometheus
message StopPrometheusMsg {}

// Message that the client sends to stop pgAdmin
message StopPgAdminMsg {}

// Message that the client sends to stop nginx
message StopNginxMsg {}

// Message that the client sends to stop flask
message StopFlaskMsg {}

// Message that the client sends to stop dockerStatsManager
message StopDockerStatsManagerMsg {}

// Message that the client sends to stop the docker engine
message StopDockerEngineMsg {}
