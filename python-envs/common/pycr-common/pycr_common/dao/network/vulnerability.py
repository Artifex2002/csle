from pycr_common.dao.network.transport_protocol import TransportProtocol


class Vulnerability:
    """
    DTO Class representing a vulnerability in the network
    """

    def __init__(self, name: str, port : int, protocol: TransportProtocol, credentials : list = None, cvss : float = 2.0,
                 cve: str = None, service: str = None):
        """
        Initializes the DTO

        :param name: the name of the vulnerability
        :param port: the port of the service of the vulnerability
        :param protocol: the protocol of the service of the vulnerability
        :param credentials: the credentials of the vulnerability
        :param cvss: the CVSS of the vulnerability
        :param cve: the CVE of the vulnerability
        :param service: the service of the vulnerability
        """
        self.name = name
        self.port = port
        self.protocol = protocol
        self.credentials = credentials
        self.cvss = cvss
        self.cve = cve
        self.service = service

    def __str__(self) -> str:
        """
        :return: a string representation of the vulnerability
        """
        return "name:{} , port:{}, protocol:{}, credentials:{}, cvss:{}, cve:{}, service:{}".format(
            self.name, self.port, self.protocol, list(map(lambda x: str(x), self.credentials)), self.cvss,
            self.cve, self.service
        )

    def copy(self) -> "Vulnerability":
        """
        :return: a copy of the vulnerability
        """
        return Vulnerability(
            name=self.name, port=self.port, protocol=self.protocol, credentials=self.credentials,
            cvss=self.cvss, cve=self.cve, service=self.service
        )

    def __eq__(self, other) -> bool:
        """
        Tests equality with another service

        :param other: the service to compare with
        :return: True if equal otherwise False
        """
        if not isinstance(other, Vulnerability):
            # don't attempt to compare against unrelated types
            return NotImplemented

        return self.name == other.name and self.protocol == other.protocol and self.port == other.port \
               and self.service==other.service

