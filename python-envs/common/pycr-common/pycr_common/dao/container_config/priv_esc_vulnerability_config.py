from pycr_common.dao.container_config.node_vulnerability_config import NodeVulnerabilityConfig
from pycr_common.dao.container_config.vulnerability_type import VulnType


class PrivEscVulnerabilityConfig(NodeVulnerabilityConfig):
    """
    DTO config for Privilege Escalation Vulnerabilities
    """

    def __init__(self, node_ip: str, vuln_type: VulnType, username: str, pw: str, root: bool, cve: str):
        """
        Initializes the DTO

        :param node_ip: the ip of the node
        :param vuln_type: the vulnerability type
        :param username: the username
        :param pw: the password
        :param root: whether it gives root access or not
        :param cve: the CVE id
        """
        super().__init__(node_ip=node_ip, vuln_type=vuln_type)
        self.username = username
        self.pw = pw
        self.root = root
        self.cve = cve

    def __str__(self) -> str:
        """
        :return: a string representation of the object
        """
        return "node_ip:{}, vuln_type:{}, root:{}, username:{}, pw:{}, cve:{}".format(
            self.node_ip, self.vuln_type, self.username, self.pw, self.cve)

